import{u as q,_ as B}from"./AuthenticatedLayout-73c3f8da.js";import{s as D,i as N,q as F,u as I,x as P,y as V,l as L,o as a,c as n,b as x,d as b,w as O,F as v,H as j,e,t as s,h as A,p as M}from"./app-4711f64c.js";const U=e("div",{class:"p-4 mt-2 max-w-[1250px] mx-auto text-3xl font-extrabold"},"Checkout",-1),H={class:"flex max-w-[1250px] mx-auto pt-4"},J={class:"w-8/12"},R={class:"flex items-stretch border-b border-b-gray-300 w-[calc(100%-100px)] pb-4 pl-4 mb-6"},T=e("div",{class:"text-gray-900 font-extrabold text-xl mr-12"}," Shipping Address ",-1),W={class:"px-4 font-semibold"},K={class:"w-4/12 border border-gray-400 rounded-md py-4 px-2"},Y={id:"payment-form"},z=e("div",{id:"card-element"},null,-1),Q={class:"flex justify-between text-xl text-red-700 font-extrabold border-y border-y-gray-300 my-3 p-2"},X=e("div",null,"Order total:",-1),G={key:0},Z={id:"submit",class:"w-full bg-yellow-400 hover:bg-yellow-500 rounded-md text-sm font-extrabold p-2"},ee={key:0,id:"button-text"},te={key:1,id:"button-text"},oe=e("p",{id:"card-error",role:"alert",class:"text-red-700 text-center font-semibold"},null,-1),se=e("div",{class:"w-[1200px] mx-auto text-xl font-bold pb-2 underline"},"Items",-1),re={class:"flex items-center py-1"},ae=["src"],ne={class:"ml-4"},le={class:"text-lg font-semibold"},de={class:"font-semibold text-red-700"},ue={__name:"Checkout",props:{intent:Object,order:Object},setup(l){const g=l,w=q(),{cart:p}=D(w),{intent:S}=N(g);let c=null,_=null,d=null,f=null,u=F(!1);const h=I({payment_intent:null});P(()=>{c=Stripe("pk_test_51MlwU6Bmw8RrKpV2Lss8SVVWQB6PwXBNaonq9CE57EhH4NYDL2J97cD1qk3CvMmPCfiKEfI4gEk2OLlS7Y8Aud1e00UkaJt1ut"),_=c.elements();var t={base:{color:"#32325d",fontFamily:"Arial, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#32325d"}},invalid:{fontFamily:"Arial, sans-serif",color:"#fa755a",iconColor:"#fa755a"}};d=_.create("card",{style:t}),d.mount("#card-element"),d.on("change",function(o){document.querySelector("button").disabled=o.empty,document.querySelector("#card-error").textContent=o.error?o.error.message:""}),f=document.getElementById("payment-form"),f.addEventListener("submit",function(o){o.preventDefault(),C(c,d,S.value.client_secret)}),setTimeout(()=>{V.Inertia.post("/checkout",{total:$(),total_decimal:m,items:p.value})},10)});const C=(t,o,r)=>{y(!0),t.confirmCardPayment(r,{payment_method:{card:o}}).then(function(i){i.error?E(i.error.message):(console.log(i.paymentIntent.id),k(i.paymentIntent.id))})},k=t=>{h.payment_intent=t,h.put("/checkout")},E=t=>{y(!1);var o=document.querySelector("#card-error");o.textContent=t,setTimeout(function(){o.textContent=""},4e3)},y=t=>{t?(document.querySelector("button").disabled=!0,u.value=!0):(document.querySelector("button").disabled=!1,u.value=!1)},m=L(()=>{let t=0;return p.value.forEach(o=>{t+=o.price}),t>0?t.toFixed(2):0}),$=()=>{if(m.value>0){let t=String(m.value).split(".").join("");return Number(t)}return 0};return(t,o)=>(a(),n(v,null,[x(b(j),{title:"Checkout"}),x(B,null,{default:O(()=>[U,e("div",H,[e("div",J,[e("div",R,[T,e("div",W,[e("div",null,s(t.$page.props.auth.user.first_name)+" "+s(t.$page.props.auth.user.last_name),1),e("div",null,s(t.$page.props.auth.address.addr1),1),e("div",null,s(t.$page.props.auth.address.addr2),1),e("div",null,s(t.$page.props.auth.address.city),1),e("div",null,s(t.$page.props.auth.address.postcode),1),e("div",null,s(t.$page.props.auth.address.country),1)])])]),e("div",K,[e("form",Y,[z,e("div",Q,[X,l.order?(a(),n("div",G,"USD: "+s(l.order.total_decimal),1)):A("",!0)]),e("button",Z,[b(u)?(a(),n("div",ee,"Processing...")):(a(),n("div",te,"Place your order in USD"))]),oe])])]),se,(a(!0),n(v,null,M(JSON.parse(l.order.items),r=>(a(),n("div",{class:"w-[1200px] mx-auto",key:r},[e("div",re,[e("img",{width:"60",src:r.image,class:"rounded-md",alt:""},null,8,ae),e("div",ne,[e("div",le,s(r.title),1),e("div",de,"$"+s(r.price),1)])])]))),128))]),_:1})],64))}};export{ue as default};
